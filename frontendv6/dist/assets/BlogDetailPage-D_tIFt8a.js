import{x as v,b as w,u as D,r,j as e,l as P,f as c,U as S,B as g,V as m}from"./index-0uBgUJAH.js";import{b as u}from"./blogPostService-DO3cpwxp.js";import{B as f}from"./constants-QRcisZg4.js";import{A as B}from"./arrow-left-B1x4Q8XC.js";import{C as I}from"./clock-DvSylXuB.js";import{S as A}from"./square-pen-Dux9Y0mH.js";import{T as E}from"./trash-2-CeUyZ5JQ.js";const G=()=>{const{id:l}=v(),n=w(),{user:a}=D(),[s,p]=r.useState(null),[j,N]=r.useState(!0),[d,o]=r.useState(!1);r.useEffect(()=>{l&&(async()=>{try{const i=await u.getPostById(l);p(i)}catch{m.error("Không thể tải bài viết."),n("/blog")}finally{N(!1)}})()},[l,n]);const y=async()=>{if(window.confirm("Bạn có chắc chắn muốn xóa bài viết này?")){o(!0);try{await u.deletePost(l),m.success("Xóa bài viết thành công!"),n("/blog")}catch{m.error("Không thể xóa bài viết.")}finally{o(!1)}}},b=t=>new Date(t).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),x=a&&f.canEditBlog(a.role,s==null?void 0:s.authorId,a.id),h=a&&f.canDeleteBlog(a.role,s==null?void 0:s.authorId,a.id);return j?e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(P,{size:"12"})})}):s?e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(c,{to:"/blog",className:"inline-flex items-center text-gray-600 hover:text-gray-900",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Quay lại danh sách bài viết"]})}),e.jsxs("article",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[s.imageUrl&&e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-64 md:h-96 object-cover"}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"mr-4",children:s.authorName}),e.jsx(I,{className:"w-4 h-4 mr-1"}),e.jsx("span",{children:b(s.createdAt)}),s.updatedAt&&s.updatedAt!==s.createdAt&&e.jsx("span",{className:"ml-2 text-xs",children:"(Đã chỉnh sửa)"})]}),(x||h)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[x&&e.jsx(c,{to:`/blog/${l}/edit`,children:e.jsxs(g,{variant:"outline",size:"sm",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Chỉnh sửa"]})}),h&&e.jsxs(g,{variant:"danger-outline",size:"sm",onClick:y,disabled:d,isLoading:d,children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Xóa"]})]})]}),s.status&&s.status!=="PUBLISHED"&&e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${s.status==="DRAFT"?"bg-gray-100 text-gray-800":s.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status==="DRAFT"?"Bản nháp":s.status==="PENDING"?"Chờ duyệt":"Đã từ chối"})}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-6",children:s.title}),e.jsx("div",{className:"prose prose-lg max-w-none",children:s.content.split(`
`).map((t,i)=>t.trim()&&e.jsx("p",{className:"mb-4 text-gray-700 leading-relaxed",children:t},i))}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map((t,i)=>e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-red-100 text-red-800",children:["#",t]},i))})})]})]})]}):e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"text-center py-20",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-700",children:"Không tìm thấy bài viết"}),e.jsx(c,{to:"/blog",className:"text-red-600 hover:text-red-700 mt-4 inline-block",children:"← Quay lại danh sách bài viết"})]})})};export{G as default};
