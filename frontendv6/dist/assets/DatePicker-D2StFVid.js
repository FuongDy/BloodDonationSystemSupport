import{r as o,j as s,C as Z}from"./index-0uBgUJAH.js";import{C as L}from"./chevron-right-C8WomcHX.js";import{C as ee}from"./chevron-left-xbWY0yrx.js";const oe=({label:O,name:m,value:d,onChange:f,required:q=!1,disabled:C=!1,minDate:b=null,maxDate:x=null,className:H="",placeholder:k="Chọn ngày",error:I,...te})=>{const[n,M]=o.useState(""),[g,u]=o.useState(new Date),[p,y]=o.useState(!1),[Y,$]=o.useState(!1),[w,N]=o.useState(!1),E=o.useRef(null);o.useEffect(()=>{if(d){M(d);try{if(d.includes("-")){const[e,t,r]=d.split("-");u(new Date(`${r}-${t}-${e}T00:00:00`))}else u(new Date(d))}catch{u(new Date)}}},[d]),o.useEffect(()=>{const e=t=>{p&&E.current&&!E.current.contains(t.target)&&(y(!1),$(!1),N(!1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[p]),o.useEffect(()=>{n!==d&&f&&m&&f({target:{value:n,name:m}})},[n,d,m,f]);const _=()=>{const e=g.getFullYear(),t=g.getMonth(),r=new Date(e,t,1),h=new Date(r);h.setDate(h.getDate()-r.getDay());const S=[],T=new Date;T.setHours(0,0,0,0);for(let F=0;F<42;F++){const a=new Date(h);a.setDate(h.getDate()+F);const J=a.getMonth()===t,K=a.getTime()===T.getTime();let D=null,j=null;if(b)if(b.includes("-")){const[l,i,c]=b.split("-");l&&i&&c&&l.length===2&&i.length===2&&c.length===4?D=new Date(`${c}-${i}-${l}T00:00:00`):D=new Date(b)}else D=new Date(b);if(x)if(x.includes("-")){const[l,i,c]=x.split("-");l&&i&&c&&l.length===2&&i.length===2&&c.length===4?j=new Date(`${c}-${i}-${l}T00:00:00`):j=new Date(x)}else j=new Date(x);let v=!1;if(n)if(/^\d{2}-\d{2}-\d{4}$/.test(n)){const[l,i,c]=n.split("-");v=new Date(`${c}-${i}-${l}T00:00:00`).setHours(0,0,0,0)===a.setHours(0,0,0,0)}else n.includes("T")?v=n.split("T")[0]===a.toISOString().split("T")[0]:v=n===a.toISOString().split("T")[0];const Q=D&&a<D,U=j&&a>j,W=Q||U;S.push({date:a,day:a.getDate(),isCurrentMonth:J,isToday:K,isSelected:v,isDisabled:W})}return S},z=e=>{if(e.isDisabled)return;const t=e.date,r=String(t.getDate()).padStart(2,"0"),h=String(t.getMonth()+1).padStart(2,"0"),S=t.getFullYear(),T=`${r}-${h}-${S}`;M(T),y(!1)},R=e=>{u(t=>{const r=new Date(t);return r.setMonth(t.getMonth()+e),r})},V=e=>{u(t=>{const r=new Date(t);return r.setMonth(e),r}),$(!1)},X=e=>{u(t=>{const r=new Date(t);return r.setFullYear(e),r}),N(!1)},A=()=>{const e=new Date().getFullYear(),t=[];for(let r=e-100;r<=e;r++)t.push(r);return t};o.useEffect(()=>{w&&setTimeout(()=>{const e=document.querySelector(".current-year-button");e&&e.scrollIntoView({behavior:"smooth",block:"center"})},100)},[w]);const B=()=>{if(!n)return k;if(/^\d{2}-\d{2}-\d{4}$/.test(n))return n;try{let e;if(n.includes("-")){const t=n.split("-");if(t[0].length===4)return e=new Date(`${t[0]}-${t[1]}-${t[2]}T00:00:00`),`${String(e.getDate()).padStart(2,"0")}-${String(e.getMonth()+1).padStart(2,"0")}-${e.getFullYear()}`;if(t[2].length===4)return n}else e=new Date(n);return isNaN(e.getTime())?k:`${String(e.getDate()).padStart(2,"0")}-${String(e.getMonth()+1).padStart(2,"0")}-${e.getFullYear()}`}catch(e){return console.error("Date parsing error:",e),k}},P=["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],G=["CN","T2","T3","T4","T5","T6","T7"];return s.jsxs("div",{className:`space-y-2 ${H}`,ref:E,children:[O&&s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:O}),s.jsxs("div",{className:"relative date-picker-container",children:[s.jsxs("button",{type:"button",onClick:()=>!C&&y(!p),disabled:C,"aria-label":"Open date picker","aria-required":q,className:`
            w-full flex items-center justify-between px-4 py-3 
            border rounded-lg bg-white text-left 
            transition-colors duration-200
            focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500
            ${I?"border-red-500":"border-gray-300"}
            ${C?"bg-gray-100 cursor-not-allowed opacity-60":"hover:border-red-300"}
          `,children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Z,{className:"w-5 h-5 text-gray-400 mr-3"}),s.jsx("span",{className:n?"text-gray-900":"text-gray-500",children:B()})]}),s.jsx(L,{className:`w-5 h-5 text-gray-400 transform transition-transform ${p?"rotate-90":""}`})]}),p&&s.jsxs("div",{className:"absolute top-full left-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-50 p-4 w-80",children:["            ",s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("button",{type:"button",onClick:()=>R(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(ee,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>{$(!Y),N(!1)},className:"px-3 py-1 text-sm font-semibold text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:P[g.getMonth()]}),s.jsx("button",{type:"button",onClick:()=>{N(!w),$(!1)},className:"px-3 py-1 text-sm font-semibold text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:g.getFullYear()})]}),s.jsx("button",{type:"button",onClick:()=>R(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(L,{className:"w-5 h-5"})})]}),Y&&s.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:P.map((e,t)=>s.jsx("button",{type:"button",onClick:()=>V(t),className:`px-3 py-2 text-sm rounded-lg transition-colors ${g.getMonth()===t?"bg-red-500 text-white font-semibold":"hover:bg-gray-100 text-gray-700"}`,children:e},e))}),w&&s.jsx("div",{className:"max-h-60 overflow-y-auto mb-4",children:s.jsx("div",{className:"grid grid-cols-4 gap-2",children:A().map(e=>s.jsx("button",{type:"button",onClick:()=>X(e),className:`px-3 py-2 text-sm rounded-lg transition-colors ${g.getFullYear()===e?"bg-red-500 text-white font-semibold current-year-button":"hover:bg-gray-100 text-gray-700"}`,children:e},e))})}),!Y&&!w&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-7 gap-1 mb-2",children:[G.map(e=>s.jsx("div",{className:"text-center text-xs font-medium text-gray-500 py-2",children:e},e)),"                "]}),s.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[_().map((e,t)=>s.jsx("button",{type:"button",onClick:()=>z(e),disabled:e.isDisabled,"aria-label":`Select date ${e.date.toLocaleDateString()}`,"aria-disabled":e.isDisabled,"aria-selected":e.isSelected,className:`
                        aspect-square flex items-center justify-center text-sm rounded-lg transition-colors
                        ${e.isCurrentMonth?"":"text-gray-300"}
                        ${e.isToday?"bg-blue-100 text-blue-600 font-semibold":""}
                        ${e.isSelected?"bg-red-500 text-white font-semibold":""}
                        ${e.isDisabled?"cursor-not-allowed opacity-50":"hover:bg-gray-100"}
                        ${!e.isSelected&&!e.isToday&&e.isCurrentMonth?"text-gray-900":""}
                      `,children:e.day},t)),"                "]})]}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-between",children:[s.jsx("button",{type:"button",onClick:()=>{M(""),y(!1),f&&m&&f({target:{value:"",name:m}})},className:"px-4 py-2 text-sm font-medium text-red-600 hover:text-red-800 transition-colors",children:"Xóa"}),s.jsx("button",{type:"button",onClick:()=>y(!1),className:"px-4 py-2 text-sm font-medium bg-red-50 text-red-600 rounded-md hover:bg-red-100 transition-colors",children:"Đóng"}),"            "]})]})]})]})};export{oe as D};
