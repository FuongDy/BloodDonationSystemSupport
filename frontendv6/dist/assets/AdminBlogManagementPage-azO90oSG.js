import{f as l,e as y,j as e,U as N,C as P,V as c,r as s}from"./index-1dtSQISR.js";import{b as g}from"./blogPostService-UkZGXigH.js";import{S as k}from"./StatusBadge-D5kv7rFB.js";import{D as C}from"./DateTimeDisplay-BybaiEr8.js";import{I as b}from"./InfoRow-DQJdw0nM.js";import{A as B}from"./ActionButtonGroup-CM-IdPWM.js";import{S as D}from"./square-pen-7fhtdvvE.js";import{C as x}from"./circle-check-big-CJhYsvhV.js";import{C as j}from"./clock-BK2pyYK-.js";import{T as I}from"./trash-2-BbyR4m6B.js";import{T as L}from"./TabNavigation-DCjSNLIa.js";import{A as $}from"./AdminPageLayout-DhKAkubx.js";import{A as U,a as T}from"./AdminContentWrapper-BZBpLfvq.js";import{P as f}from"./plus-C4tZkhei.js";import"./Badge-DVxHSo1W.js";import"./constants-QRcisZg4.js";import"./PageHeader-W4hk3_1v.js";import"./Pagination-DEb_1VK8.js";import"./chevron-left-ByYWtYPx.js";import"./chevron-right-B4c0w1B6.js";const K=({post:t,onStatusChange:m,onDelete:d})=>{if(!t||!t.id)return null;const u=async()=>{try{await g.approvePost(t.id),c.success("Đã duyệt bài viết thành công!"),m()}catch(i){c.error(`Không thể duyệt bài viết: ${i.message}`)}},r=async()=>{if(window.confirm("Bạn có chắc chắn muốn xóa bài viết này không?"))try{await g.deletePost(t.id),c.success("Đã xóa bài viết thành công!"),d()}catch(i){c.error(`Không thể xóa bài viết: ${i.message}`)}},h=i=>{switch(i){case"PUBLISHED":return"Đã xuất bản";case"PENDING":return"Chờ duyệt";case"DRAFT":return"Bản nháp";case"REJECTED":return"Bị từ chối";default:return i}},a=[{label:"Xem",icon:y,variant:"outline",component:l,to:`/blog/${t.id}`,target:"_blank",rel:"noopener noreferrer"},{label:"Sửa",icon:D,variant:"outline",component:l,to:`/blog/${t.id}/edit`}];return t.status==="PENDING"&&a.push({label:"Duyệt",icon:x,variant:"primary",onClick:u}),a.push({label:"Xóa",icon:I,variant:"danger-outline",onClick:r}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[t.imageUrl&&e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(k,{status:t.status,text:h(t.status),icon:t.status==="PUBLISHED"?x:j}),e.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",t.id]})]}),"        ",e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:t.title||"Tiêu đề không xác định"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:t.content?`${t.content.substring(0,150)}...`:"Không có nội dung"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx(b,{icon:N,label:"Tác giả",value:t.authorName||"Chưa xác định"}),e.jsx(b,{icon:P,label:"Tạo",value:e.jsx(C,{date:t.createdAt})}),t.publishedAt&&e.jsx(b,{icon:P,label:"Xuất bản",value:e.jsx(C,{date:t.publishedAt})}),t.viewCount&&e.jsx(b,{icon:y,label:"Lượt xem",value:t.viewCount})]}),e.jsx(B,{actions:a})]})]})},at=()=>{const[t,m]=s.useState({content:[],totalElements:0}),[d,u]=s.useState({content:[],totalElements:0}),[r,h]=s.useState(!0),[a,i]=s.useState("published"),v=s.useCallback(async()=>{h(!0);try{const[n,o]=await Promise.all([g.getAllPublishedPosts(0,20),g.getPendingPosts(0,20)]);m({content:(n==null?void 0:n.content)||n||[],totalElements:(n==null?void 0:n.totalElements)||0}),u({content:(o==null?void 0:o.content)||o||[],totalElements:(o==null?void 0:o.totalElements)||0})}catch(n){console.error("Error fetching blog posts:",n),c.error("Không thể tải danh sách bài viết."),m({content:[],totalElements:0}),u({content:[],totalElements:0})}finally{h(!1)}},[]);s.useEffect(()=>{v()},[v]);const p=()=>{v()},S=[{key:"published",label:`Đã xuất bản (${t.totalElements||0})`,icon:x},{key:"pending",label:`Chờ duyệt (${d.totalElements||0})`,icon:j}],E=a==="published"?t.content||[]:d.content||[],w=[{label:"Làm mới",icon:y,variant:"outline",onClick:p,disabled:r,className:r?"animate-spin":""},{label:"Tạo bài viết mới",icon:f,variant:"primary",component:l,to:"/blog/create"}],A=()=>a==="published"?e.jsx(T,{icon:x,title:"Chưa có bài viết nào được xuất bản",description:"Tạo bài viết mới hoặc duyệt các bài viết đang chờ duyệt.",action:{label:"Tạo bài viết mới",icon:f,component:l,to:"/blog/create"}}):e.jsx(T,{icon:j,title:"Không có bài viết nào chờ duyệt",description:"Tất cả bài viết đã được xử lý.",action:{label:"Tạo bài viết mới",icon:f,component:l,to:"/blog/create"}});return e.jsxs($,{title:"Quản lý Blog",description:"Quản lý và duyệt các bài viết blog",actions:w,children:[e.jsx(L,{tabs:S,activeTab:a,onTabChange:i}),e.jsx(U,{isLoading:r,isEmpty:E.length===0,emptyStateComponent:A(),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(n=>e.jsx(K,{post:n,onStatusChange:p,onDelete:p},n.id))})})]})};export{at as default};
