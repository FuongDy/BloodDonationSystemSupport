import{r as i,u as F,a as L,b as M,h as C,c as S,j as e,H as E,U as G,M as H,P as U,C as X,D as z,d as Q,L as J,E as P,e as I,f as b}from"./index-CLUoxoAg.js";import{D as K}from"./DatePicker-DXnV2bY9.js";import{b as W}from"./bloodTypeService-CHVPaQSk.js";import{C as Y}from"./circle-check-big-DeP-VlS6.js";import{A as Z}from"./arrow-left-EWlVf4Oe.js";import"./chevron-right-Dplm1_a-.js";const le=()=>{const[l,D]=i.useState({fullName:"",email:"",phone:"",address:"",dateOfBirth:"",password:"",confirmPassword:"",bloodTypeId:"",agreeTerms:!1}),[h,q]=i.useState(!1),[u,A]=i.useState(!1),[j,y]=i.useState([]),[n,N]=i.useState(!1),[s,m]=i.useState({}),{requestRegistration:B,isAuthenticated:w,loading:a}=F(),{showNotification:x,setLoading:v}=L(),g=M(),k=i.useCallback(async()=>{N(!0);try{const t=await W.getAll();y(t||[])}catch(t){C(t,x),y([])}finally{N(!1)}},[x]);i.useEffect(()=>{w?g("/",{replace:!0}):k()},[w,g,k]);const d=i.useCallback(async t=>{const{name:r,value:o,type:c,checked:$}=t.target,R=c==="checkbox"?$:o;D(p=>{const T={...p,[r]:R};return setTimeout(async()=>{try{await S.validateAt(r,T),m(f=>({...f,[r]:""}))}catch(f){m(V=>({...V,[r]:f.message}))}},0),T}),s[r]&&m(p=>({...p,[r]:""}))},[s]),O=async t=>{t.preventDefault();try{await S.validate(l,{abortEarly:!1}),m({}),v(!0);const r={...l,bloodTypeId:l.bloodTypeId?parseInt(l.bloodTypeId,10):null};delete r.confirmPassword,delete r.agreeTerms,console.log("=== REGISTER REQUEST ==="),console.log("Registration Data:",r),console.log("======================="),await B(r),x("Mã OTP đã được gửi! Vui lòng kiểm tra email.","success"),g("/verify-otp",{state:{registrationData:r}})}catch(r){if(r.name==="ValidationError"){const o={};r.inner.forEach(c=>{o[c.path]=c.message}),m(o),x("Vui lòng kiểm tra lại thông tin đăng ký.","error")}else C(r,x)}finally{v(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 via-white to-pink-50",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-40 -right-32 w-80 h-80 bg-red-100 rounded-full opacity-30 blur-3xl"}),e.jsx("div",{className:"absolute -bottom-40 -left-32 w-80 h-80 bg-pink-100 rounded-full opacity-30 blur-3xl"})]}),e.jsxs("div",{className:"relative min-h-screen flex",children:[e.jsx("div",{className:"hidden lg:flex lg:w-2/5 flex-col justify-center items-center bg-gradient-to-br from-red-600 to-pink-600 text-white p-8",children:e.jsxs("div",{className:"max-w-sm text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",children:e.jsx(E,{className:"w-10 h-10 text-white"})})}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Tham gia cộng đồng"}),e.jsx("p",{className:"text-lg text-red-100 mb-6 font-light",children:"Trở thành người hùng cứu người với những giọt máu quý giá"}),e.jsxs("div",{className:"space-y-3 text-left",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold",children:"1"})}),e.jsx("span",{className:"text-red-100",children:"Đăng ký tài khoản"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold",children:"2"})}),e.jsx("span",{className:"text-red-100",children:"Xác thực thông tin"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold",children:"3"})}),e.jsx("span",{className:"text-red-100",children:"Bắt đầu hiến máu"})]})]})]})}),e.jsx("div",{className:"w-full lg:w-3/5 flex items-center justify-center p-4 lg:p-8",children:e.jsxs("div",{className:"max-w-2xl w-full",children:[e.jsxs("div",{className:"lg:hidden text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-4",children:e.jsx(E,{className:"w-8 h-8 text-red-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Đăng ký tài khoản"}),e.jsx("p",{className:"text-gray-600",children:"Tham gia cộng đồng hiến máu nhân đạo"})]}),e.jsxs("div",{className:"hidden lg:block text-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Tạo tài khoản mới"}),e.jsx("p",{className:"text-gray-600",children:"Điền thông tin để tham gia cộng đồng"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 lg:p-8 border border-gray-100",children:e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center border-b pb-2",children:[e.jsx(G,{className:"w-5 h-5 mr-2 text-red-600"}),"Thông tin cá nhân"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Họ và tên đầy đủ *"}),e.jsx("input",{id:"fullName",name:"fullName",type:"text",value:l.fullName,onChange:d,placeholder:"Ví dụ: Nguyễn Văn An",required:!0,disabled:a||n,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors ${s.fullName?"border-red-300 bg-red-50":"border-gray-300 bg-white"}`}),s.fullName&&e.jsx("p",{className:"text-xs text-red-600",children:s.fullName})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center",children:[e.jsx(H,{className:"w-4 h-4 mr-1 text-gray-500"}),"Email *"]}),e.jsx("input",{id:"email",name:"email",type:"email",value:l.email,onChange:d,placeholder:"your.email@example.com",required:!0,disabled:a||n,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors ${s.email?"border-red-300 bg-red-50":"border-gray-300 bg-white"}`}),s.email&&e.jsx("p",{className:"text-xs text-red-600",children:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center",children:[e.jsx(U,{className:"w-4 h-4 mr-1 text-gray-500"}),"Số điện thoại *"]}),e.jsx("input",{id:"phone",name:"phone",type:"tel",value:l.phone,onChange:d,placeholder:"0987654321",required:!0,disabled:a||n,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors ${s.phone?"border-red-300 bg-red-50":"border-gray-300 bg-white"}`}),s.phone&&e.jsx("p",{className:"text-xs text-red-600",children:s.phone})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(K,{label:e.jsxs("div",{className:"flex items-center text-sm font-medium text-gray-700",children:[e.jsx(X,{className:"w-4 h-4 mr-1 text-gray-500"}),"Ngày sinh *"]}),name:"dateOfBirth",value:l.dateOfBirth,onChange:d,required:!0,maxDate:new Date().toISOString().split("T")[0],placeholder:"Chọn ngày sinh",disabled:a||n}),s.dateOfBirth&&e.jsx("p",{className:"text-xs text-red-600",children:s.dateOfBirth})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-1 text-gray-500"}),"Nhóm máu"]}),n?e.jsxs("div",{className:"w-full px-4 py-3 border rounded-lg bg-gray-50 flex items-center justify-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Đang tải..."})]}):e.jsxs("select",{id:"bloodTypeId",name:"bloodTypeId",value:l.bloodTypeId,onChange:d,disabled:a||n||j.length===0,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors ${s.bloodTypeId?"border-red-300 bg-red-50":"border-gray-300 bg-white"}`,children:[e.jsx("option",{value:"",children:"-- Chọn nhóm máu --"}),j.filter((t,r,o)=>r===o.findIndex(c=>c.bloodGroup===t.bloodGroup)).map(t=>e.jsx("option",{value:t.id,children:t.bloodGroup},t.id))]}),s.bloodTypeId&&e.jsx("p",{className:"text-xs text-red-600",children:s.bloodTypeId})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-1 text-gray-500"}),"Địa chỉ *"]}),e.jsx("textarea",{id:"address",name:"address",value:l.address,onChange:d,placeholder:"Số nhà, đường, phường/xã, quận/huyện, tỉnh/thành phố",required:!0,disabled:a||n,rows:2,className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors resize-none ${s.address?"border-red-300 bg-red-50":"border-gray-300 bg-white"}`}),s.address&&e.jsx("p",{className:"text-xs text-red-600",children:s.address})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center border-b pb-2",children:[e.jsx(J,{className:"w-5 h-5 mr-2 text-red-600"}),"Thông tin bảo mật"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Mật khẩu *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",name:"password",type:h?"text":"password",value:l.password,onChange:d,placeholder:"Ít nhất 6 ký tự",required:!0,disabled:a||n,className:`w-full px-4 py-3 pr-12 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors ${s.password?"border-red-300 bg-red-50":"border-gray-300 bg-white"}`}),e.jsx("button",{type:"button",onClick:()=>q(!h),disabled:a,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:h?e.jsx(P,{className:"w-5 h-5"}):e.jsx(I,{className:"w-5 h-5"})})]}),s.password&&e.jsx("p",{className:"text-xs text-red-600",children:s.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Xác nhận mật khẩu *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:u?"text":"password",value:l.confirmPassword,onChange:d,placeholder:"Nhập lại mật khẩu",required:!0,disabled:a||n,className:`w-full px-4 py-3 pr-12 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors ${s.confirmPassword?"border-red-300 bg-red-50":"border-gray-300 bg-white"}`}),e.jsx("button",{type:"button",onClick:()=>A(!u),disabled:a,className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:u?e.jsx(P,{className:"w-5 h-5"}):e.jsx(I,{className:"w-5 h-5"})})]}),s.confirmPassword&&e.jsx("p",{className:"text-xs text-red-600",children:s.confirmPassword})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{id:"agreeTerms",name:"agreeTerms",type:"checkbox",checked:l.agreeTerms,onChange:d,disabled:a||n,required:!0,className:`w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500 mt-1 ${s.agreeTerms?"border-red-500":""}`}),e.jsxs("label",{htmlFor:"agreeTerms",className:"ml-2 block text-sm text-gray-700",children:["Tôi đã đọc và đồng ý với"," ",e.jsx(b,{to:"/terms",className:"font-medium text-red-600 hover:text-red-500 hover:underline",children:"Điều khoản sử dụng"})," ","và"," ",e.jsx(b,{to:"/privacy",className:"font-medium text-red-600 hover:text-red-500 hover:underline",children:"Chính sách bảo mật"})," ","của hệ thống."]})]}),s.agreeTerms&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:s.agreeTerms})]}),e.jsx("button",{type:"submit",disabled:a||n||Object.keys(s).some(t=>s[t]),className:`w-full bg-gradient-to-r from-red-600 to-pink-600 text-white font-semibold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none ${a?"cursor-wait":""}`,children:e.jsxs("div",{className:"flex items-center justify-center",children:[a?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}):e.jsx(Y,{className:"w-5 h-5 mr-2"}),a?"Đang tạo tài khoản...":"Tạo tài khoản"]})}),e.jsx("div",{className:"text-center pt-4 border-t",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Đã có tài khoản?"," ",e.jsxs(b,{to:"/login",className:"font-medium text-red-600 hover:text-red-500 inline-flex items-center group",children:[e.jsx(Z,{className:"w-4 h-4 mr-1 group-hover:-translate-x-1 transition-transform"}),"Đăng nhập ngay"]})]})})]})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Sau khi đăng ký, bạn sẽ nhận được email xác thực để kích hoạt tài khoản"})})]})})]})]})};export{le as default};
