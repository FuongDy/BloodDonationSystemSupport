import{r as i,V as c,j as e,B as r,c as N,L as x,d as D,U as E,C as f}from"./index---XYpbwv.js";import{b as h}from"./blogPostService-BW_bxcWH.js";import"./Badge-oS4_q8it.js";import{C as g}from"./circle-check-big-BhElR3sU.js";import{C as v}from"./clock-DJtAe62-.js";import{P as p}from"./plus-DIBgbZhv.js";import{S}from"./square-pen-B_DZs_bD.js";import{T}from"./trash-2-2oCXCowO.js";const B=({post:s,onStatusChange:u,onDelete:m})=>{const d=a=>new Date(a).toLocaleDateString("vi-VN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=async()=>{try{await h.approvePost(s.id),c.success("Đã duyệt bài viết thành công!"),u()}catch{c.error("Không thể duyệt bài viết.")}},o=async()=>{if(window.confirm("Bạn có chắc chắn muốn xóa bài viết này không?"))try{await h.deletePost(s.id),c.success("Đã xóa bài viết thành công!"),m()}catch{c.error("Không thể xóa bài viết.")}},l=a=>{switch(a){case"PUBLISHED":return"bg-green-100 text-green-800 border-green-200";case"PENDING":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"DRAFT":return"bg-gray-100 text-gray-800 border-gray-200";case"REJECTED":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[s.imageUrl&&e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${l(s.status)}`,children:[s.status==="PUBLISHED"&&e.jsx(g,{className:"w-3 h-3 mr-1"}),s.status==="PENDING"&&e.jsx(v,{className:"w-3 h-3 mr-1"}),s.status==="PUBLISHED"?"Đã xuất bản":s.status==="PENDING"?"Chờ duyệt":s.status==="DRAFT"?"Bản nháp":s.status==="REJECTED"?"Bị từ chối":s.status]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",s.id]})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:s.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:s.content?s.content.substring(0,150)+"...":"Không có nội dung"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:s.authorName||"Chưa xác định"})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["Tạo: ",d(s.createdAt)]})]}),s.publishedAt&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:["Xuất bản: ",d(s.publishedAt)]})]}),s.viewCount&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{children:[s.viewCount," lượt xem"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{to:`/blog/${s.id}`,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"Xem"]})}),e.jsx(x,{to:`/blog/${s.id}/edit`,children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"Sửa"]})}),s.status==="PENDING"&&e.jsxs(r,{onClick:n,variant:"primary",size:"sm",children:[e.jsx(g,{className:"w-4 h-4 mr-1"}),"Duyệt"]}),e.jsxs(r,{onClick:o,variant:"danger-outline",size:"sm",children:[e.jsx(T,{className:"w-4 h-4 mr-1"}),"Xóa"]})]})]})]})},K=()=>{const[s,u]=i.useState({content:[],totalElements:0}),[m,d]=i.useState({content:[],totalElements:0}),[n,o]=i.useState(!0),[l,a]=i.useState("published"),b=i.useCallback(async()=>{o(!0);try{const[t,y]=await Promise.all([h.getAllPublishedPosts(0,20),h.getPendingPosts(0,20)]);u(t),d(y)}catch{c.error("Không thể tải danh sách bài viết.")}finally{o(!1)}},[]);i.useEffect(()=>{b()},[b]);const j=()=>{b()},P=[{key:"published",label:`Đã xuất bản (${s.totalElements})`,icon:g},{key:"pending",label:`Chờ duyệt (${m.totalElements})`,icon:v}],w=l==="published"?s.content:m.content;return e.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Quản lý Blog"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Quản lý và duyệt các bài viết blog"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(r,{onClick:j,disabled:n,variant:"outline",children:[e.jsx(N,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),"Làm mới"]}),e.jsx(x,{to:"/blog/create",children:e.jsxs(r,{variant:"primary",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Tạo bài viết mới"]})})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6","aria-label":"Tabs",children:P.map(({key:t,label:y,icon:C})=>e.jsxs("button",{onClick:()=>a(t),className:`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center transition-colors ${l===t?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),y]},t))})})}),n?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(D,{size:"12"})}):w.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(t=>e.jsx(B,{post:t,onStatusChange:j,onDelete:j},t.id))}):e.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[l==="published"?e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Chưa có bài viết nào được xuất bản"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Tạo bài viết mới hoặc duyệt các bài viết đang chờ duyệt."})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Không có bài viết nào chờ duyệt"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Tất cả bài viết đã được xử lý."})]}),e.jsx(x,{to:"/blog/create",children:e.jsxs(r,{variant:"primary",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Tạo bài viết mới"]})})]})})]})})};export{K as default};
